# name: test/sql/hashfuncs.test
# description: test hashfuncs extension
# group: [sql]

# Require statement will ensure this test is run with this extension loaded
require hashfuncs

# Confirm the extension works
query I
SELECT xxh32('hello world');
----
3468387874

query I
SELECT xxh32('hello world', 42);
----
4225033588

query I
SELECT xxh64('hello world');
----
5020219685658847592

query I
SELECT xxh64('hello world', 12345);
----
15771590491225725957

query I
SELECT xxh3_64('hello world');
----
15296390279056496779

query I
SELECT xxh3_64('hello world', 999);
----
3002856137354040482

query I
SELECT xxh3_128('hello world');
----
225447084758876380551077147957698971904

query I
SELECT xxh3_128('hello world', 777);
----
283192007746380917896797379546610829141

#query I
#SELECT rapidhash('hello world');
#----
#3397907815814400320

#query I
#SELECT rapidhash('hello world', 2023);
#----
#11789095433300219990

query I
SELECT murmurhash3_32('hello world');
----
1586663183

query I
SELECT murmurhash3_32('hello world', 123);
----
679062093

query I
SELECT murmurhash3_128('hello world');
----
206095855024402301784664199839047883400

query I
SELECT murmurhash3_x64_128('hello world');
----
228083453807047072434243676435732455694

query I
SELECT xxh3_64('hello world', 1)
----
13235715547166781229

statement ok
CREATE TABLE test_values(
  val text
)

statement ok
INSERT INTO test_values (val) VALUES
('A3f9xZ'),
('hello_world'),
('q''weRtY'),
('42!cat$'),
('sql_test_01'),
('Xx''danger''xX'),
('n9m2K8L7'),
('simple_text'),
('p@ssw0rd!'),
('UPPERlowerMix'),
('duck_db''rocks'),
('fuzzy-match%'),
('end2end_case'),
('JUMP!_high'),
('trail_space '),
('line_break\nok'),
('O''Reilly_book'),
('hash#tag123'),
('escape\\slash'),
('final_value!');

query I
SELECT xxh3_64(val, 1) from test_values
----
9754535182523702330
11661378664393350035
8109071181876277224
16234135117497592658
2927978092978827887
16750940650443631283
7119428214417206077
4210528920377293408
5869958256225688692
1161672286215593427
6976703038538397740
2407943583849160645
13712770218863691053
3300961290780186348
12347262961048241831
4327665800250596801
18230737118419112974
5556604607352908546
10347174678819671130
2012751273537724327